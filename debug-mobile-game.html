<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>SpermRace.io - Mobile Game Debug</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Courier New', monospace;
      background: #000;
      color: #00f5ff;
      overflow: hidden;
    }
    
    #debug-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    #game-frame {
      flex: 1;
      border: none;
      width: 100%;
    }
    
    #stats-overlay {
      position: fixed;
      top: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.9);
      border: 2px solid #00f5ff;
      border-radius: 8px;
      padding: 12px;
      font-size: 11px;
      line-height: 1.6;
      min-width: 220px;
      z-index: 99999;
      box-shadow: 0 0 20px rgba(0, 245, 255, 0.5);
    }
    
    #stats-overlay strong {
      color: #fff;
      display: block;
      margin-bottom: 8px;
      font-size: 13px;
    }
    
    hr {
      border: 0;
      border-top: 1px solid rgba(0, 245, 255, 0.3);
      margin: 8px 0;
    }
    
    .stat-row {
      display: flex;
      justify-content: space-between;
      margin: 3px 0;
    }
    
    .stat-label {
      color: #888;
    }
    
    .stat-value {
      color: #00f5ff;
      font-weight: bold;
    }
    
    .fps-good { color: #00ff00 !important; }
    .fps-medium { color: #ffaa00 !important; }
    .fps-bad { color: #ff0000 !important; }
    
    #controls {
      position: fixed;
      bottom: 10px;
      left: 10px;
      background: rgba(0, 0, 0, 0.9);
      border: 2px solid #00f5ff;
      border-radius: 8px;
      padding: 12px;
      z-index: 99999;
    }
    
    button {
      background: linear-gradient(135deg, #00f5ff, #00d4ff);
      border: none;
      color: #000;
      padding: 8px 16px;
      border-radius: 6px;
      font-weight: bold;
      font-size: 12px;
      cursor: pointer;
      margin: 4px;
      font-family: inherit;
    }
    
    button:active {
      transform: scale(0.95);
    }
    
    #screenshot-preview {
      position: fixed;
      bottom: 60px;
      left: 10px;
      max-width: 200px;
      border: 2px solid #00f5ff;
      border-radius: 4px;
      display: none;
    }
  </style>
</head>
<body>
  <div id="debug-container">
    <iframe id="game-frame" src="https://spermrace.io"></iframe>
    
    <div id="stats-overlay">
      <strong>ðŸŽ® MOBILE GAME DEBUG</strong>
      <div class="stat-row">
        <span class="stat-label">FPS:</span>
        <span class="stat-value" id="fps">--</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">Device:</span>
        <span class="stat-value" id="device">--</span>
      </div>
      <hr>
      <div class="stat-row">
        <span class="stat-label">Viewport:</span>
        <span class="stat-value" id="viewport">--</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">DPR:</span>
        <span class="stat-value" id="dpr">--</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">Canvas Size:</span>
        <span class="stat-value" id="canvas-size">--</span>
      </div>
      <hr>
      <div class="stat-row">
        <span class="stat-label">Memory:</span>
        <span class="stat-value" id="memory">--</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">GPU:</span>
        <span class="stat-value" id="gpu">--</span>
      </div>
      <hr>
      <div class="stat-row">
        <span class="stat-label">Network:</span>
        <span class="stat-value" id="network">--</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">Latency:</span>
        <span class="stat-value" id="latency">--</span>
      </div>
    </div>
    
    <div id="controls">
      <button onclick="captureScreenshot()">ðŸ“¸ Screenshot</button>
      <button onclick="toggleStats()">ðŸ“Š Toggle Stats</button>
      <button onclick="reloadGame()">ðŸ”„ Reload</button>
    </div>
    
    <img id="screenshot-preview" alt="Screenshot preview">
  </div>

  <script>
    let lastFrameTime = performance.now();
    let fps = 60;
    let statsVisible = true;
    
    // Device detection
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    const isAndroid = /Android/i.test(navigator.userAgent);
    const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
    
    // Update device info
    document.getElementById('device').textContent = 
      isAndroid ? 'ðŸ“± Android' : 
      isIOS ? 'ðŸ“± iOS' : 
      isMobile ? 'ðŸ“± Mobile' : 
      'ðŸ–¥ï¸ Desktop';
    
    // Update viewport info
    function updateViewportInfo() {
      const vw = window.innerWidth;
      const vh = window.innerHeight;
      const dpr = window.devicePixelRatio || 1;
      
      document.getElementById('viewport').textContent = `${vw}Ã—${vh}`;
      document.getElementById('dpr').textContent = `${dpr.toFixed(2)}x`;
      document.getElementById('canvas-size').textContent = 
        `${Math.round(vw * dpr)}Ã—${Math.round(vh * dpr)}`;
    }
    
    // Calculate FPS
    function updateFPS() {
      const now = performance.now();
      const delta = now - lastFrameTime;
      fps = Math.round(1000 / delta);
      lastFrameTime = now;
      
      const fpsEl = document.getElementById('fps');
      fpsEl.textContent = fps;
      fpsEl.className = 'stat-value ' + 
        (fps >= 50 ? 'fps-good' : 
         fps >= 30 ? 'fps-medium' : 
         'fps-bad');
      
      requestAnimationFrame(updateFPS);
    }
    
    // Update memory info
    function updateMemoryInfo() {
      if (performance.memory) {
        const used = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024);
        const total = Math.round(performance.memory.totalJSHeapSize / 1024 / 1024);
        document.getElementById('memory').textContent = `${used}/${total} MB`;
      } else {
        document.getElementById('memory').textContent = 'N/A';
      }
    }
    
    // Get GPU info
    function getGPUInfo() {
      try {
        const canvas = document.createElement('canvas');
        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
        if (gl) {
          const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
          if (debugInfo) {
            const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
            document.getElementById('gpu').textContent = 
              renderer.length > 25 ? renderer.substring(0, 25) + '...' : renderer;
          } else {
            document.getElementById('gpu').textContent = 'WebGL';
          }
        } else {
          document.getElementById('gpu').textContent = 'No WebGL';
        }
      } catch (e) {
        document.getElementById('gpu').textContent = 'Unknown';
      }
    }
    
    // Get network info
    function updateNetworkInfo() {
      if (navigator.connection) {
        const conn = navigator.connection;
        const type = conn.effectiveType || conn.type || 'unknown';
        document.getElementById('network').textContent = type.toUpperCase();
        
        // Estimate latency
        if (conn.rtt) {
          document.getElementById('latency').textContent = `${conn.rtt}ms`;
        } else {
          document.getElementById('latency').textContent = 'N/A';
        }
      } else {
        document.getElementById('network').textContent = 'Unknown';
        document.getElementById('latency').textContent = 'N/A';
      }
    }
    
    // Capture screenshot
    function captureScreenshot() {
      const iframe = document.getElementById('game-frame');
      const preview = document.getElementById('screenshot-preview');
      
      // Note: Can't capture iframe content due to CORS
      // Instead, show message
      alert('ðŸ“¸ Screenshot Info:\n\n' +
            'To capture the game:\n' +
            '1. Use device screenshot (Power+Volume)\n' +
            '2. Or use browser DevTools\n' +
            '3. Or screen recording\n\n' +
            'Current Stats:\n' +
            'FPS: ' + fps + '\n' +
            'Resolution: ' + document.getElementById('viewport').textContent + '\n' +
            'DPR: ' + document.getElementById('dpr').textContent);
    }
    
    // Toggle stats visibility
    function toggleStats() {
      statsVisible = !statsVisible;
      document.getElementById('stats-overlay').style.display = 
        statsVisible ? 'block' : 'none';
    }
    
    // Reload game
    function reloadGame() {
      document.getElementById('game-frame').src = 
        'https://spermrace.io?' + Date.now();
    }
    
    // Initialize
    updateViewportInfo();
    getGPUInfo();
    updateNetworkInfo();
    updateFPS();
    
    // Update memory every 2 seconds
    setInterval(updateMemoryInfo, 2000);
    updateMemoryInfo();
    
    // Update network every 5 seconds
    setInterval(updateNetworkInfo, 5000);
    
    // Update viewport on resize
    window.addEventListener('resize', updateViewportInfo);
    
    // Log all console messages from iframe
    window.addEventListener('message', (event) => {
      if (event.data && event.data.type === 'console') {
        console.log('[GAME]', event.data.message);
      }
    });
    
    console.log('ðŸŽ® Mobile Game Debug Tool Active');
    console.log('Device:', document.getElementById('device').textContent);
    console.log('Viewport:', document.getElementById('viewport').textContent);
    console.log('DPR:', document.getElementById('dpr').textContent);
  </script>
</body>
</html>
